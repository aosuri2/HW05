---
title: "World Development Indicators HW05"
author: "Anita Osuri"
date: "2025-10-07"
format:
  html: default
execute:
  echo: false
bibliography: references.bib
---

## 

```{r}
#Reading the data wdi
getwd()
wdi<-read.csv("/Users/anitaosuri/Downloads/wdi.csv")
#View(wdi)
```

```{r}
#exploring potential categories to look at for the three analyses
str(wdi)
```

3 & 4) Conduct exploratory data analysis on at least three indicators of your choice. Summarise your findings in markdown sections. Show your code and results. Create at least two different types of plots (e.g., bar chart, scatter plot) to represent your analysis. Use Quarto code chunks to embed these visualisations. Add a title and axis labels to each plot. Use Quarto to include a caption and a reference to the source of the data. Hide your code in the final document.

## Education Expenditure and Primary School Enrollment

This section explores the relationship between national education spending and primary school enrollment rates using 2022 data from the World Bank.

There is no strong linear relationship between education expenditure and primary school enrollment. It seems that regardless of the education expenditure (% of GDP), the primary enrollment rate still stays consistently around 100%. This suggests that there are other factors besides education spending that can alter primary enrollment.

```{r}
#| label: fig-edu-enroll
#| fig-cap: "Education Expenditure vs Primary School Enrollment (World Bank, 2022)"
#| echo: false

library(ggplot2)

ggplot(wdi, aes(x = education_expenditure_gdp_share, y = primary_school_enrolment_rate)) +
  geom_point(color = "steelblue", size = 2, alpha = 0.7) +
  labs(
    title = "Relationship between Education Expenditure and Primary School Enrollment (2022)",
    x = "Education Expenditure (% of GDP)",
    y = "Primary School Enrollment Rate (%)",
    caption = "Source: World Development Indicators (World Bank, 2022)"
  ) +
  theme_minimal()
```

## Health Expenditure and Measles Immunization Rate

This section examines the relationship between health spending as a share of GDP and measles immunization coverage. The data come from the World Bank.

This shows that there is no strong relationship between health expenditure (as percent of gdp share) and measles immunization rate. There is clustering near high immunization rates (just below 100%), regardless of health expenditure per % of gdp. This demonstrates that there are other factors affecting measles immunization rate besides health spending.

```{r}
#| label: fig-health-measles
#| fig-cap: "Health Expenditure vs Measles Immunization Rate (World Bank, 2022)"
#| echo: false

library(ggplot2)

ggplot(wdi, aes(x = health_expenditure_gdp_share, y = measles_immunisation_rate)) +
  geom_point(color = "darkgreen", size = 2, alpha = 0.7) +
  labs(
    title = "Health Expenditure vs Measles Immunization Rate (2022)",
    x = "Health Expenditure (% of GDP)",
    y = "Measles Immunization Rate (%)",
    caption = "Source: World Development Indicators (World Bank, 2022)"
  ) +
  theme_minimal()
```

## Average Life Expectancy by Country

This section examines the relationship between the country and average life expectancy in a bar plot. The data come from the World Bank.

This demonstrates the countries that have the 10 highest life expectancy numbers. All of the countries are smaller countries and mainly high income with high healthcare standards as well. The differences between the life expectancies are very minimal based on the bar graph.

```{r}
#| label: fig-lifeexp-bar
#| fig-cap: "Average Life Expectancy by Country (World Bank, 2022)"
#| echo: false

library(dplyr)
library(ggplot2)

top10_lifeexp <- wdi %>%
  arrange(desc(life_expectancy)) %>%
  slice_head(n = 10)

ggplot(top10_lifeexp, aes(x = reorder(country, life_expectancy), y = life_expectancy)) +
  geom_col(fill = "steelblue") +
  coord_flip() +
  labs(
    title = "Top 10 Countries by Life Expectancy (2022)",
    x = "Country",
    y = "Life Expectancy (years)",
    caption = "Source: World Development Indicators (World Bank, 2022)"
  ) +
  theme_minimal()
```

5)  Construct a table that highlights some key statistics from your analysis. Ensure the table is well-formatted and included in the report.

```{r}
#| label: tbl-summary
#| tbl-cap: "Summary Statistics for Selected Indicators (World Bank, 2022)"
#| echo: false

library(dplyr)
library(knitr)

summary_table <- wdi %>%
  summarise(
    mean_life_exp = mean(life_expectancy, na.rm = TRUE),
    median_life_exp = median(life_expectancy, na.rm = TRUE),
    sd_life_exp = sd(life_expectancy, na.rm = TRUE),

    mean_health_exp = mean(health_expenditure_gdp_share, na.rm = TRUE),
    median_health_exp = median(health_expenditure_gdp_share, na.rm = TRUE),
    sd_health_exp = sd(health_expenditure_gdp_share, na.rm = TRUE),

    mean_edu_exp = mean(education_expenditure_gdp_share, na.rm = TRUE),
    median_edu_exp = median(education_expenditure_gdp_share, na.rm = TRUE),
    sd_edu_exp = sd(education_expenditure_gdp_share, na.rm = TRUE)
  )

kable(
  summary_table,
  digits = 2,
  caption = "Summary Statistics for Life Expectancy, Health Expenditure, and Education Expenditure"
)

```
